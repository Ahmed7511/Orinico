<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet"  href="style.css" >
    <script src="https://kit.fontawesome.com/c10c83c5b7.js" crossorigin="anonymous"></script>
    <script>
                     
    </script>

    <title>product-orinico</title>
</head>
<body>

  <header>
    <nav>
      <ul> 
       <li><span href="index.html">Orinico</span></li>
       <li class="cart">
        <a href="panier.html">
         <i class="fas fa-shopping-cart"></i>panier<span>0</span>
            </a>
       </li>
     </ul>
    </nav>
  </header>
 <h1> Choisir ce produit</h1>

  <p>Personnaliser votre produit  </p>
<div id="product" >

</div>




                  <a id = "add-cart" href="panier.html">Ajouter au panier</a>



          <aside>
              <h3>Toute l'équipe d'Orinoco vous remercie de votre visite.</h3>
          </aside>
  

           <footer class="socials">
                               <a class="social" href="index.html"><span class="fa fa-twitter"></span><br>twitter</a>
      
                                <a class="social" href="index.html"><span class="fa fa-facebook"></span><br>facebook</a>
  
                                <a class="social" href="index.html"><span class="fa fa-dribbble"></span><br>dribbble</a>
  
                                <a class="social" href="index.html"><span class="fa fa-instagram"></span><br>instagram</a>  
            </footer>
            
  

             <script >
               const lien = window.location.search.substring(4)

       function main(){

       var request = new XMLHttpRequest();

       request.open('GET' , 'http://localhost:3000/api/cameras/'+ lien);


request.onload = function (){

  if(this.status == 200){
    var product = JSON.parse(request.responseText);

    var output=""
    output += '<div class="product">'+
              '<img src="' + product.imageUrl+'">' +
              '<ul>' +
             '<li><strong>ID :</strong>' +product._id +' </li>' +
             '<li><strong>Lentille :</strong>' +
              '<select><option name="lentille" value ="lenses[0]"> ' +
                 product.lenses[0] +'<option name="lentille" value="lenses[1]">' + product.lenses[1] +'</select>' + 
                '</li>' +
               '<li><strong>Name :</strong>' +product.name +' </li>' +
                 '<li><strong>Price :</strong>' +product.price/100+'€' +' </li>' +
                  '<li><strong>Description :</strong>' +product.description +' </li>' +
                  '</ul>' +
                  '</div>'

                      }
                    document.getElementById('product').innerHTML = output ;


                };

request.send();
 
}

main();
let cart = document.getElementById('add-cart');

cart.addEventListener('click', () =>{
     cartNumbers(product); // on click on lance la function
})

function onloadCartNumbers(){
  let productNumbers = localStorage.getItem('cartNumbers');
if(productNumbers){
  document.querySelector('.cart span').textContent = productNumbers ; 
}
}

function cartNumbers(product){
 
let productNumbers = localStorage.getItem('cartNumbers');
console.log(productNumbers)
productNumbers = parseInt(productNumbers);            // converti le productNumbers en numéro 
if(productNumbers){

localStorage.setItem('cartNumbers',productNumbers + 1);
document.querySelector('.cart span').textContent = productNumbers + 1;

}else{
  localStorage.setItem('cartNumbers', 1);
  document.querySelector('.cart span').textContent = 1;
}

}

 localStorage.setItem("mon produit ",JSON.parse.product);
console.log(localStorage)
onloadCartNumbers();

       </script>



        </body>
</html>